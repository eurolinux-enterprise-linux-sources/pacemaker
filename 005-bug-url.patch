From 55c576d970ed5b3446204668e7439d626e6d1a13 Mon Sep 17 00:00:00 2001
From: Ken Gaillot <kgaillot@redhat.com>
Date: Fri, 29 Mar 2019 19:48:23 -0500
Subject: [PATCH 1/3] Build: configure: make bug report URL configurable

to allow distributions to direct users to their own bug reporters
---
 configure.ac | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/configure.ac b/configure.ac
index 70e074e..6fd17fd 100644
--- a/configure.ac
+++ b/configure.ac
@@ -318,6 +318,12 @@ AC_ARG_WITH(brand,
     [ test x"$withval" = x"no" || PUBLICAN_BRAND="$withval" ])
 AC_SUBST(PUBLICAN_BRAND)
 
+BUG_URL=""
+AC_ARG_WITH(bug-url,
+    [  --with-bug-url=DIR  Address where users should submit bug reports @<:@https://bugs.clusterlabs.org/enter_bug.cgi?product=Pacemaker@:>@],
+    [ BUG_URL="$withval" ]
+)
+
 ASCIIDOC_CLI_TYPE="pcs"
 AC_ARG_WITH(doc-cli,
     [  --with-doc-cli=cli_type  CLI type to use for generated documentation. [$ASCIIDOC_CLI_TYPE]],
@@ -442,6 +448,10 @@ if test x"${CONFIGDIR}" = x""; then
 fi
 AC_SUBST(CONFIGDIR)
 
+if test x"${BUG_URL}" = x""; then
+    BUG_URL="https://bugs.clusterlabs.org/enter_bug.cgi?product=Pacemaker"
+fi
+
 for j in prefix exec_prefix bindir sbindir libexecdir datadir sysconfdir \
     sharedstatedir localstatedir libdir includedir oldincludedir infodir \
     mandir INITDIR docdir CONFIGDIR
-- 
1.8.3.1


From 6c5938df90f83dcd686f11453ae701099a98836b Mon Sep 17 00:00:00 2001
From: Ken Gaillot <kgaillot@redhat.com>
Date: Fri, 29 Mar 2019 19:50:21 -0500
Subject: [PATCH 2/3] Feature: tools: make crm_report bug report URL
 configurable at build time

should have been done with 52aaffd
---
 configure.ac        | 1 +
 tools/crm_report.in | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/configure.ac b/configure.ac
index 6fd17fd..ed51f67 100644
--- a/configure.ac
+++ b/configure.ac
@@ -451,6 +451,7 @@ AC_SUBST(CONFIGDIR)
 if test x"${BUG_URL}" = x""; then
     BUG_URL="https://bugs.clusterlabs.org/enter_bug.cgi?product=Pacemaker"
 fi
+AC_SUBST(BUG_URL)
 
 for j in prefix exec_prefix bindir sbindir libexecdir datadir sysconfdir \
     sharedstatedir localstatedir libdir includedir oldincludedir infodir \
diff --git a/tools/crm_report.in b/tools/crm_report.in
index 8e0d4b6..63c137c 100755
--- a/tools/crm_report.in
+++ b/tools/crm_report.in
@@ -230,7 +230,7 @@ EOF
 	log "Collected results are available in $fname"
 	log " "
 	log "Please create a bug entry at"
-	log "    http://bugs.clusterlabs.org/enter_bug.cgi?product=Pacemaker"
+	log "    @BUG_URL@"
 	log "Include a description of your problem and attach this tarball"
 	log " "
 	log "Thank you for taking time to create this report."
-- 
1.8.3.1


From d99c1fa3fd52be01e03ce27a964fb1b09d29c46c Mon Sep 17 00:00:00 2001
From: Ken Gaillot <kgaillot@redhat.com>
Date: Tue, 2 Apr 2019 10:35:16 -0500
Subject: [PATCH 3/3] Test: tools: define missing constant

accidentally omitted in abc33eff
---
 tools/regression.sh | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/tools/regression.sh b/tools/regression.sh
index 0c38629..3680f13 100755
--- a/tools/regression.sh
+++ b/tools/regression.sh
@@ -8,6 +8,8 @@ GREP_OPTIONS=
 verbose=0
 tests="dates tools acls validity"
 
+CRM_EX_OK=0
+
 function test_assert() {
     target=$1; shift
     cib=$1; shift
-- 
1.8.3.1

